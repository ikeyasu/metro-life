'use strict';

describe('Controller: MainCtrl', function () {

  // load the controller's module
  beforeEach(module('metroLifeApp'));

  var MainCtrl,
      scope,
      $httpBackend;

  // Initialize the controller and a mock scope
  beforeEach(inject(function (_$httpBackend_, $controller, $rootScope) {
    $httpBackend = _$httpBackend_;
    $httpBackend.expectGET('/api/tokyometro/trains/delayed')
      .respond([]);
    $httpBackend.expectGET('/api/tokyometro/trains/nearby/odpt.Station:TokyoMetro.Tozai.Urayasu')
      .respond({'odpt.Station:TokyoMetro.Tozai.NishiFunabashi':[{'@context':'http://vocab.tokyometroapp.jp/context_odpt_Train.jsonld','@type':'odpt:Train','@id':'urn:ucode:_00001C000000000000010000030CAB32','dc:date':'2014-11-01T16:01:50+09:00','dct:valid':'2014-11-01T16:03:20+09:00','odpt:frequency':90,'odpt:railway':'odpt.Railway:TokyoMetro.Tozai','owl:sameAs':'odpt.Train:TokyoMetro.Tozai.A1549S','odpt:trainNumber':'A1549S','odpt:trainType':'odpt.TrainType:TokyoMetro.Local','odpt:delay':0,'odpt:startingStation':'odpt.Station:JR-East.Chuo.Mitaka','odpt:terminalStation':'odpt.Station:TokyoMetro.Tozai.NishiFunabashi','odpt:fromStation':'odpt.Station:TokyoMetro.Tozai.Kasai','odpt:toStation':null,'odpt:railDirection':'odpt.RailDirection:TokyoMetro.NishiFunabashi','odpt:trainOwner':'odpt.TrainOwner:TokyoMetro'},{'@context':'http://vocab.tokyometroapp.jp/context_odpt_Train.jsonld','@type':'odpt:Train','@id':'urn:ucode:_00001C000000000000010000030CAB28','dc:date':'2014-11-01T16:01:50+09:00','dct:valid':'2014-11-01T16:03:20+09:00','odpt:frequency':90,'odpt:railway':'odpt.Railway:TokyoMetro.Tozai','owl:sameAs':'odpt.Train:TokyoMetro.Tozai.A1563S','odpt:trainNumber':'A1563S','odpt:trainType':'odpt.TrainType:TokyoMetro.Rapid','odpt:delay':0,'odpt:startingStation':'odpt.Station:TokyoMetro.Tozai.Nakano','odpt:terminalStation':'odpt.Station:ToyoRapidRailway.ToyoRapid.ToyoKatsutadai','odpt:fromStation':'odpt.Station:TokyoMetro.Tozai.MinamiSunamachi','odpt:toStation':'odpt.Station:TokyoMetro.Tozai.NishiKasai','odpt:railDirection':'odpt.RailDirection:TokyoMetro.NishiFunabashi','odpt:trainOwner':'odpt.TrainOwner:TokyoMetro'},{'@context':'http://vocab.tokyometroapp.jp/context_odpt_Train.jsonld','@type':'odpt:Train','@id':'urn:ucode:_00001C000000000000010000030CAB30','dc:date':'2014-11-01T16:01:50+09:00','dct:valid':'2014-11-01T16:03:20+09:00','odpt:frequency':90,'odpt:railway':'odpt.Railway:TokyoMetro.Tozai','owl:sameAs':'odpt.Train:TokyoMetro.Tozai.A1503K','odpt:trainNumber':'A1503K','odpt:trainType':'odpt.TrainType:TokyoMetro.Local','odpt:delay':0,'odpt:startingStation':'odpt.Station:TokyoMetro.Tozai.Nakano','odpt:terminalStation':'odpt.Station:TokyoMetro.Tozai.NishiFunabashi','odpt:fromStation':'odpt.Station:TokyoMetro.Tozai.Kiba','odpt:toStation':null,'odpt:railDirection':'odpt.RailDirection:TokyoMetro.NishiFunabashi','odpt:trainOwner':'odpt.TrainOwner:JR-East'},{'@context':'http://vocab.tokyometroapp.jp/context_odpt_Train.jsonld','@type':'odpt:Train','@id':'urn:ucode:_00001C000000000000010000030CAA06','dc:date':'2014-11-01T16:01:50+09:00','dct:valid':'2014-11-01T16:03:20+09:00','odpt:frequency':90,'odpt:railway':'odpt.Railway:TokyoMetro.Tozai','owl:sameAs':'odpt.Train:TokyoMetro.Tozai.A1525S','odpt:trainNumber':'A1525S','odpt:trainType':'odpt.TrainType:TokyoMetro.Local','odpt:delay':0,'odpt:startingStation':'odpt.Station:JR-East.Chuo.Mitaka','odpt:terminalStation':'odpt.Station:TokyoMetro.Tozai.NishiFunabashi','odpt:fromStation':'odpt.Station:TokyoMetro.Tozai.Nihombashi','odpt:toStation':null,'odpt:railDirection':'odpt.RailDirection:TokyoMetro.NishiFunabashi','odpt:trainOwner':'odpt.TrainOwner:TokyoMetro'},{'@context':'http://vocab.tokyometroapp.jp/context_odpt_Train.jsonld','@type':'odpt:Train','@id':'urn:ucode:_00001C000000000000010000030CAB33','dc:date':'2014-11-01T16:01:50+09:00','dct:valid':'2014-11-01T16:03:20+09:00','odpt:frequency':90,'odpt:railway':'odpt.Railway:TokyoMetro.Tozai','owl:sameAs':'odpt.Train:TokyoMetro.Tozai.A1515S','odpt:trainNumber':'A1515S','odpt:trainType':'odpt.TrainType:TokyoMetro.Rapid','odpt:delay':0,'odpt:startingStation':'odpt.Station:TokyoMetro.Tozai.Nakano','odpt:terminalStation':'odpt.Station:ToyoRapidRailway.ToyoRapid.ToyoKatsutadai','odpt:fromStation':'odpt.Station:TokyoMetro.Tozai.Takebashi','odpt:toStation':'odpt.Station:TokyoMetro.Tozai.Otemachi','odpt:railDirection':'odpt.RailDirection:TokyoMetro.NishiFunabashi','odpt:trainOwner':'odpt.TrainOwner:TokyoMetro'},{'@context':'http://vocab.tokyometroapp.jp/context_odpt_Train.jsonld','@type':'odpt:Train','@id':'urn:ucode:_00001C000000000000010000030CAA08','dc:date':'2014-11-01T16:01:50+09:00','dct:valid':'2014-11-01T16:03:20+09:00','odpt:frequency':90,'odpt:railway':'odpt.Railway:TokyoMetro.Tozai','owl:sameAs':'odpt.Train:TokyoMetro.Tozai.A1543S','odpt:trainNumber':'A1543S','odpt:trainType':'odpt.TrainType:TokyoMetro.Local','odpt:delay':0,'odpt:startingStation':'odpt.Station:TokyoMetro.Tozai.Nakano','odpt:terminalStation':'odpt.Station:TokyoMetro.Tozai.NishiFunabashi','odpt:fromStation':'odpt.Station:TokyoMetro.Tozai.Iidabashi','odpt:toStation':null,'odpt:railDirection':'odpt.RailDirection:TokyoMetro.NishiFunabashi','odpt:trainOwner':'odpt.TrainOwner:TokyoMetro'},{'@context':'http://vocab.tokyometroapp.jp/context_odpt_Train.jsonld','@type':'odpt:Train','@id':'urn:ucode:_00001C000000000000010000030CA931','dc:date':'2014-11-01T16:01:50+09:00','dct:valid':'2014-11-01T16:03:20+09:00','odpt:frequency':90,'odpt:railway':'odpt.Railway:TokyoMetro.Tozai','owl:sameAs':'odpt.Train:TokyoMetro.Tozai.A1527S','odpt:trainNumber':'A1527S','odpt:trainType':'odpt.TrainType:TokyoMetro.Local','odpt:delay':0,'odpt:startingStation':'odpt.Station:JR-East.Chuo.Mitaka','odpt:terminalStation':'odpt.Station:TokyoMetro.Tozai.NishiFunabashi','odpt:fromStation':'odpt.Station:TokyoMetro.Tozai.Waseda','odpt:toStation':null,'odpt:railDirection':'odpt.RailDirection:TokyoMetro.NishiFunabashi','odpt:trainOwner':'odpt.TrainOwner:TokyoMetro'},{'@context':'http://vocab.tokyometroapp.jp/context_odpt_Train.jsonld','@type':'odpt:Train','@id':'urn:ucode:_00001C000000000000010000030CAB31','dc:date':'2014-11-01T16:01:50+09:00','dct:valid':'2014-11-01T16:03:20+09:00','odpt:frequency':90,'odpt:railway':'odpt.Railway:TokyoMetro.Tozai','owl:sameAs':'odpt.Train:TokyoMetro.Tozai.A1554T','odpt:trainNumber':'A1554T','odpt:trainType':'odpt.TrainType:TokyoMetro.Rapid','odpt:delay':0,'odpt:startingStation':'odpt.Station:TokyoMetro.Tozai.Nakano','odpt:terminalStation':'odpt.Station:ToyoRapidRailway.ToyoRapid.ToyoKatsutadai','odpt:fromStation':'odpt.Station:TokyoMetro.Tozai.Ochiai','odpt:toStation':null,'odpt:railDirection':'odpt.RailDirection:TokyoMetro.NishiFunabashi','odpt:trainOwner':'odpt.TrainOwner:ToyoRapidRailway'},{'@context':'http://vocab.tokyometroapp.jp/context_odpt_Train.jsonld','@type':'odpt:Train','@id':'urn:ucode:_00001C000000000000010000030CA933','dc:date':'2014-11-01T16:01:50+09:00','dct:valid':'2014-11-01T16:03:20+09:00','odpt:frequency':90,'odpt:railway':'odpt.Railway:TokyoMetro.Tozai','owl:sameAs':'odpt.Train:TokyoMetro.Tozai.A1660T','odpt:trainNumber':'A1660T','odpt:trainType':'odpt.TrainType:TokyoMetro.Local','odpt:delay':0,'odpt:startingStation':'odpt.Station:TokyoMetro.Tozai.Nakano','odpt:terminalStation':'odpt.Station:ToyoRapidRailway.ToyoRapid.ToyoKatsutadai','odpt:fromStation':'odpt.Station:TokyoMetro.Tozai.Nakano','odpt:toStation':null,'odpt:railDirection':'odpt.RailDirection:TokyoMetro.NishiFunabashi','odpt:trainOwner':'odpt.TrainOwner:ToyoRapidRailway'}],'odpt.Station:TokyoMetro.Tozai.Nakano':[{'@context':'http://vocab.tokyometroapp.jp/context_odpt_Train.jsonld','@type':'odpt:Train','@id':'urn:ucode:_00001C000000000000010000030CAC69','dc:date':'2014-11-01T16:01:50+09:00','dct:valid':'2014-11-01T16:03:20+09:00','odpt:frequency':90,'odpt:railway':'odpt.Railway:TokyoMetro.Tozai','owl:sameAs':'odpt.Train:TokyoMetro.Tozai.B1537S','odpt:trainNumber':'B1537S','odpt:trainType':'odpt.TrainType:TokyoMetro.Rapid','odpt:delay':0,'odpt:startingStation':'odpt.Station:TokyoMetro.Tozai.NishiFunabashi','odpt:terminalStation':'odpt.Station:TokyoMetro.Tozai.Nakano','odpt:fromStation':'odpt.Station:TokyoMetro.Tozai.MinamiGyotoku','odpt:toStation':'odpt.Station:TokyoMetro.Tozai.Urayasu','odpt:railDirection':'odpt.RailDirection:TokyoMetro.Nakano','odpt:trainOwner':'odpt.TrainOwner:TokyoMetro'},{'@context':'http://vocab.tokyometroapp.jp/context_odpt_Train.jsonld','@type':'odpt:Train','@id':'urn:ucode:_00001C000000000000010000030CAAEE','dc:date':'2014-11-01T16:01:50+09:00','dct:valid':'2014-11-01T16:03:20+09:00','odpt:frequency':90,'odpt:railway':'odpt.Railway:TokyoMetro.Tozai','owl:sameAs':'odpt.Train:TokyoMetro.Tozai.B1553S','odpt:trainNumber':'B1553S','odpt:trainType':'odpt.TrainType:TokyoMetro.Local','odpt:delay':0,'odpt:startingStation':'odpt.Station:TokyoMetro.Tozai.NishiFunabashi','odpt:terminalStation':'odpt.Station:JR-East.Chuo.Mitaka','odpt:fromStation':'odpt.Station:TokyoMetro.Tozai.BarakiNakayama','odpt:toStation':'odpt.Station:TokyoMetro.Tozai.Myoden','odpt:railDirection':'odpt.RailDirection:TokyoMetro.Nakano','odpt:trainOwner':'odpt.TrainOwner:TokyoMetro'},{'@context':'http://vocab.tokyometroapp.jp/context_odpt_Train.jsonld','@type':'odpt:Train','@id':'urn:ucode:_00001C000000000000010000030CAA19','dc:date':'2014-11-01T16:01:50+09:00','dct:valid':'2014-11-01T16:03:20+09:00','odpt:frequency':90,'odpt:railway':'odpt.Railway:TokyoMetro.Tozai','owl:sameAs':'odpt.Train:TokyoMetro.Tozai.B1635S','odpt:trainNumber':'B1635S','odpt:trainType':'odpt.TrainType:TokyoMetro.Local','odpt:delay':0,'odpt:startingStation':'odpt.Station:TokyoMetro.Tozai.NishiFunabashi','odpt:terminalStation':'odpt.Station:TokyoMetro.Tozai.Nakano','odpt:fromStation':'odpt.Station:TokyoMetro.Tozai.NishiFunabashi','odpt:toStation':null,'odpt:railDirection':'odpt.RailDirection:TokyoMetro.Nakano','odpt:trainOwner':'odpt.TrainOwner:TokyoMetro'}]});

    scope = $rootScope.$new();
    MainCtrl = $controller('MainCtrl', {
      $scope: scope
    });
  }));

  it('should attach a list of trains to the scope', function () {
    $httpBackend.flush();
    expect(scope.trains.length).toBe(0);
  });

  it('should attach a object of trains to the scope', function () {
    $httpBackend.flush();
    expect(scope.nearbyTrainList).toBeDefined();
    console.log(scope.nearbyTrainList[0]);
    expect(scope.nearbyTrainList[0].fromStation).toEqual('odpt.Station:TokyoMetro.Tozai.Kasai');
  });
});
